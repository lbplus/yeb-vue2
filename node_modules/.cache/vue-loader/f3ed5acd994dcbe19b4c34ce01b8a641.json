{"remainingRequest":"C:\\Users\\Administrator\\Desktop\\yeb2\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Administrator\\Desktop\\yeb2\\src\\views\\sys\\SysAdmin.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\Administrator\\Desktop\\yeb2\\src\\views\\sys\\SysAdmin.vue","mtime":1669965619070},{"path":"C:\\Users\\Administrator\\Desktop\\yeb2\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Desktop\\yeb2\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\Users\\Administrator\\Desktop\\yeb2\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Desktop\\yeb2\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQpleHBvcnQgZGVmYXVsdCB7DQogIG5hbWU6ICJTeXNBZG1pbiIsDQogIGRhdGEoKSB7DQogICAgcmV0dXJuIHsNCiAgICAgIGFkbWluczogW10sDQogICAgICBrZXl3b3JkczogIiIsDQogICAgICBhbGxSb2xlczogW10sDQogICAgICBzZWxlY3RSb2xlczogW10sDQogICAgfTsNCiAgfSwNCiAgbW91bnRlZCgpIHsNCiAgICB0aGlzLmluaXRBZG1pbnMoKTsNCiAgfSwNCiAgbWV0aG9kczogew0KICAgIGhpZGVQb3AoYWRtaW4pIHsNCiAgICAgIGxldCByb2xlcyA9IFtdOw0KICAgICAgT2JqZWN0LmFzc2lnbihyb2xlcywgYWRtaW4ucm9sZXMpOw0KICAgICAgbGV0IGZsYWcgPSBmYWxzZTsNCiAgICAgIGlmIChyb2xlcy5sZW5ndGggIT0gdGhpcy5zZWxlY3RSb2xlcy5sZW5ndGgpIHsNCiAgICAgICAgZmxhZyA9IHRydWU7DQogICAgICB9IGVsc2Ugew0KICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHJvbGVzLmxlbmd0aDsgaSsrKSB7DQogICAgICAgICAgbGV0IHJvbGUgPSByb2xlc1tpXTsNCiAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IHRoaXMuc2VsZWN0Um9sZXMubGVuZ3RoOyBqKyspIHsNCiAgICAgICAgICAgIGxldCBzciA9IHRoaXMuc2VsZWN0Um9sZXNbal07DQogICAgICAgICAgICBpZiAocm9sZS5pZCA9PSBzcikgew0KICAgICAgICAgICAgICByb2xlcy5zcGxpY2UoaSwgMSk7DQogICAgICAgICAgICAgIGktLTsNCiAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICB9DQogICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIGlmIChyb2xlcy5sZW5ndGggIT0gMCkgew0KICAgICAgICAgIGZsYWcgPSB0cnVlOw0KICAgICAgICB9DQogICAgICB9DQogICAgICBpZiAoZmxhZykgew0KICAgICAgICBsZXQgdXJsID0gIi9hZG1pbi91cGRhdGVyb2xlP2FkbWluSWQ9IiArIGFkbWluLmlkOw0KICAgICAgICB0aGlzLnNlbGVjdFJvbGVzLmZvckVhY2goKHJzKSA9PiB7DQogICAgICAgICAgdXJsICs9ICImcmlkcz0iICsgcnM7DQogICAgICAgIH0pOw0KICAgICAgICB0aGlzLnB1dFJlcXVlc3QodXJsKS50aGVuKChyZXNwKSA9PiB7DQogICAgICAgICAgaWYgKHJlc3ApIHsNCiAgICAgICAgICAgIHRoaXMuaW5pdEFkbWlucygpOw0KICAgICAgICAgIH0NCiAgICAgICAgfSk7DQogICAgICB9DQogICAgfSwNCiAgICBzaG93UG9wKGFkbWluKSB7DQogICAgICB0aGlzLmluaXRBbGxSb2xlcygpOw0KICAgICAgbGV0IHJvbGVzID0gYWRtaW4ucm9sZXM7DQogICAgICB0aGlzLnNlbGVjdFJvbGVzID0gW107DQogICAgICByb2xlcy5mb3JFYWNoKChyKSA9PiB7DQogICAgICAgIHRoaXMuc2VsZWN0Um9sZXMucHVzaChyLmlkKTsNCiAgICAgIH0pOw0KICAgIH0sDQogICAgaW5pdEFsbFJvbGVzKCkgew0KICAgICAgdGhpcy5nZXRSZXF1ZXN0KCIvYWRtaW4vcm9sZXMiKS50aGVuKChyZXNwKSA9PiB7DQogICAgICAgIGlmIChyZXNwKSB7DQogICAgICAgICAgdGhpcy5hbGxSb2xlcyA9IHJlc3A7DQogICAgICAgIH0NCiAgICAgIH0pOw0KICAgIH0sDQogICAgZW5hYmxlZENoYW5nZShhZG1pbikgew0KICAgICAgdGhpcy5wdXRSZXF1ZXN0KCIvYWRtaW4vdXBkYXRlIiwgYWRtaW4pLnRoZW4oKHJlc3ApID0+IHsNCiAgICAgICAgaWYgKHJlc3ApIHsNCiAgICAgICAgICB0aGlzLmluaXRBZG1pbnMoKTsNCiAgICAgICAgfQ0KICAgICAgfSk7DQogICAgfSwNCiAgICBkZWxldGVBZG1pbihhZG1pbikgew0KICAgICAgdGhpcy4kY29uZmlybSgNCiAgICAgICAgIuatpOaTjeS9nOWwhuawuOS5heWIoOmZpCIgKyBhZG1pbi5uYW1lICsgIueUqOaItywg5piv5ZCm57un57utPyIsDQogICAgICAgICLmj5DnpLoiLA0KICAgICAgICB7DQogICAgICAgICAgY29uZmlybUJ1dHRvblRleHQ6ICLnoa7lrpoiLA0KICAgICAgICAgIGNhbmNlbEJ1dHRvblRleHQ6ICLlj5bmtogiLA0KICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwNCiAgICAgICAgfQ0KICAgICAgKQ0KICAgICAgICAudGhlbigoKSA9PiB7DQogICAgICAgICAgdGhpcy5kZWxldGVSZXF1ZXN0KCIvYWRtaW4vZGVsZXRlP2lkPSIgKyBhZG1pbi5pZCkudGhlbigocmVzcCkgPT4gew0KICAgICAgICAgICAgaWYgKHJlc3ApIHsNCiAgICAgICAgICAgICAgdGhpcy5pbml0QWRtaW5zKCk7DQogICAgICAgICAgICB9DQogICAgICAgICAgfSk7DQogICAgICAgIH0pDQogICAgICAgIC5jYXRjaCgoKSA9PiB7DQogICAgICAgICAgdGhpcy4kbWVzc2FnZSh7DQogICAgICAgICAgICB0eXBlOiAiaW5mbyIsDQogICAgICAgICAgICBtZXNzYWdlOiAi5bey5Y+W5raI5Yig6ZmkIiwNCiAgICAgICAgICB9KTsNCiAgICAgICAgfSk7DQogICAgfSwNCg0KICAgIGRvU2VhcmNoKCkgew0KICAgICAgdGhpcy5pbml0QWRtaW5zKCk7DQogICAgfSwNCiAgICBpbml0QWRtaW5zKCkgew0KICAgICAgdGhpcy5nZXRSZXF1ZXN0KCIvYWRtaW4vbGlzdD9rZXl3b3Jkcz0iICsgdGhpcy5rZXl3b3JkcykudGhlbigocmVzcCkgPT4gew0KICAgICAgICBpZiAocmVzcCkgew0KICAgICAgICAgIHRoaXMuYWRtaW5zID0gcmVzcDsNCiAgICAgICAgfQ0KICAgICAgfSk7DQogICAgfSwNCiAgfSwNCn07DQo="},{"version":3,"sources":["SysAdmin.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"SysAdmin.vue","sourceRoot":"src/views/sys","sourcesContent":["<template>\r\n  <div>\r\n    <div style=\"display: flex; justify-content: center; margin-top: 20px\">\r\n      <el-input\r\n        placeholder=\"通过用户名搜索用户\"\r\n        prefix-icon=\"el-icon-search\"\r\n        style=\"width: 400px; margin-right: 20px\"\r\n        v-model=\"keywords\"\r\n        @keydown.enter.native=\"doSearch\"\r\n      ></el-input>\r\n      <el-button type=\"primary\" icon=\"el-icon-search\" @click=\"doSearch\"\r\n        >搜索</el-button\r\n      >\r\n    </div>\r\n    <div class=\"admin-container\">\r\n      <el-card class=\"admin-card\" v-for=\"(admin, index) in admins\" :key=\"index\">\r\n        <div slot=\"header\" class=\"clearfix\">\r\n          <span>{{ admin.name }}</span>\r\n          <el-button\r\n            style=\"float: right; padding: 3px 0; color: red\"\r\n            type=\"text\"\r\n            icon=\"el-icon-delete\"\r\n            @click=\"deleteAdmin(admin)\"\r\n          ></el-button>\r\n        </div>\r\n        <div>\r\n          <div class=\"img-content\">\r\n            <img\r\n              :src=\"admin.userFace\"\r\n              :alt=\"admin.name\"\r\n              :title=\"admin.name\"\r\n              class=\"userFace-img\"\r\n            />\r\n          </div>\r\n        </div>\r\n        <div class=\"userInfo\">\r\n          <div>姓名:{{ admin.name }}</div>\r\n          <div>手机号码:{{ admin.phone }}</div>\r\n          <div>电话号码:{{ admin.telephone }}</div>\r\n          <div>地址:{{ admin.address }}</div>\r\n          <div>\r\n            用户状态:\r\n            <el-switch\r\n              v-model=\"admin.enabled\"\r\n              active-color=\"#13ce66\"\r\n              inactive-color=\"#ff4949\"\r\n              active-text=\"启用\"\r\n              inactive-text=\"禁用\"\r\n              @change=\"enabledChange(admin)\"\r\n            >\r\n            </el-switch>\r\n          </div>\r\n          <div>\r\n            用户角色:\r\n            <el-tag\r\n              style=\"margin-right: 10px\"\r\n              type=\"success\"\r\n              v-for=\"(role, indexj) in admin.roles\"\r\n              :key=\"indexj\"\r\n              >{{ role.nameZh }}</el-tag\r\n            >\r\n            <el-popover\r\n              placement=\"right\"\r\n              title=\"角色列表\"\r\n              width=\"200\"\r\n              @show=\"showPop(admin)\"\r\n              @hide=\"hidePop(admin)\"\r\n              trigger=\"click\"\r\n            >\r\n              <el-select v-model=\"selectRoles\" multiple placeholder=\"请选择\">\r\n                <el-option\r\n                  v-for=\"(r, index) in allRoles\"\r\n                  :key=\"index\"\r\n                  :label=\"r.nameZh\"\r\n                  :value=\"r.id\"\r\n                >\r\n                </el-option>\r\n              </el-select>\r\n              <el-button\r\n                slot=\"reference\"\r\n                type=\"text\"\r\n                icon=\"el-icon-more\"\r\n              ></el-button>\r\n            </el-popover>\r\n          </div>\r\n          <div>备注: {{ admin.remark }}</div>\r\n        </div>\r\n      </el-card>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: \"SysAdmin\",\r\n  data() {\r\n    return {\r\n      admins: [],\r\n      keywords: \"\",\r\n      allRoles: [],\r\n      selectRoles: [],\r\n    };\r\n  },\r\n  mounted() {\r\n    this.initAdmins();\r\n  },\r\n  methods: {\r\n    hidePop(admin) {\r\n      let roles = [];\r\n      Object.assign(roles, admin.roles);\r\n      let flag = false;\r\n      if (roles.length != this.selectRoles.length) {\r\n        flag = true;\r\n      } else {\r\n        for (let i = 0; i < roles.length; i++) {\r\n          let role = roles[i];\r\n          for (let j = 0; j < this.selectRoles.length; j++) {\r\n            let sr = this.selectRoles[j];\r\n            if (role.id == sr) {\r\n              roles.splice(i, 1);\r\n              i--;\r\n              break;\r\n            }\r\n          }\r\n        }\r\n        if (roles.length != 0) {\r\n          flag = true;\r\n        }\r\n      }\r\n      if (flag) {\r\n        let url = \"/admin/updaterole?adminId=\" + admin.id;\r\n        this.selectRoles.forEach((rs) => {\r\n          url += \"&rids=\" + rs;\r\n        });\r\n        this.putRequest(url).then((resp) => {\r\n          if (resp) {\r\n            this.initAdmins();\r\n          }\r\n        });\r\n      }\r\n    },\r\n    showPop(admin) {\r\n      this.initAllRoles();\r\n      let roles = admin.roles;\r\n      this.selectRoles = [];\r\n      roles.forEach((r) => {\r\n        this.selectRoles.push(r.id);\r\n      });\r\n    },\r\n    initAllRoles() {\r\n      this.getRequest(\"/admin/roles\").then((resp) => {\r\n        if (resp) {\r\n          this.allRoles = resp;\r\n        }\r\n      });\r\n    },\r\n    enabledChange(admin) {\r\n      this.putRequest(\"/admin/update\", admin).then((resp) => {\r\n        if (resp) {\r\n          this.initAdmins();\r\n        }\r\n      });\r\n    },\r\n    deleteAdmin(admin) {\r\n      this.$confirm(\r\n        \"此操作将永久删除\" + admin.name + \"用户, 是否继续?\",\r\n        \"提示\",\r\n        {\r\n          confirmButtonText: \"确定\",\r\n          cancelButtonText: \"取消\",\r\n          type: \"warning\",\r\n        }\r\n      )\r\n        .then(() => {\r\n          this.deleteRequest(\"/admin/delete?id=\" + admin.id).then((resp) => {\r\n            if (resp) {\r\n              this.initAdmins();\r\n            }\r\n          });\r\n        })\r\n        .catch(() => {\r\n          this.$message({\r\n            type: \"info\",\r\n            message: \"已取消删除\",\r\n          });\r\n        });\r\n    },\r\n\r\n    doSearch() {\r\n      this.initAdmins();\r\n    },\r\n    initAdmins() {\r\n      this.getRequest(\"/admin/list?keywords=\" + this.keywords).then((resp) => {\r\n        if (resp) {\r\n          this.admins = resp;\r\n        }\r\n      });\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style>\r\n.admin-card {\r\n  width: 350px;\r\n  margin-bottom: 20px;\r\n}\r\n.admin-container {\r\n  display: flex;\r\n  margin-top: 20px;\r\n  justify-content: space-around;\r\n  flex-wrap: wrap;\r\n}\r\n.userFace-img {\r\n  width: 60px;\r\n  height: 60px;\r\n  border-radius: 30px;\r\n}\r\n.img-content {\r\n  width: 100%;\r\n  display: flex;\r\n  justify-content: center;\r\n}\r\n.userInfo {\r\n  font-size: 12px;\r\n  color: skyblue;\r\n}\r\n</style>"]}]}