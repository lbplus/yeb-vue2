{"remainingRequest":"C:\\Users\\Administrator\\Desktop\\yeb2\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Administrator\\Desktop\\yeb2\\src\\views\\sys\\SysAdmin.vue?vue&type=style&index=0&lang=css&","dependencies":[{"path":"C:\\Users\\Administrator\\Desktop\\yeb2\\src\\views\\sys\\SysAdmin.vue","mtime":1636877722577},{"path":"C:\\Users\\Administrator\\Desktop\\yeb2\\node_modules\\@vue\\cli-service\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Desktop\\yeb2\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Desktop\\yeb2\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Desktop\\yeb2\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Desktop\\yeb2\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCg0KLmFkbWluLWNhcmQgew0KICB3aWR0aDogMzUwcHg7DQogIG1hcmdpbi1ib3R0b206IDIwcHg7DQp9DQouYWRtaW4tY29udGFpbmVyIHsNCiAgZGlzcGxheTogZmxleDsNCiAgbWFyZ2luLXRvcDogMjBweDsNCiAganVzdGlmeS1jb250ZW50OiBzcGFjZS1hcm91bmQ7DQogIGZsZXgtd3JhcDogd3JhcDsNCn0NCi51c2VyRmFjZS1pbWcgew0KICB3aWR0aDogNjBweDsNCiAgaGVpZ2h0OiA2MHB4Ow0KICBib3JkZXItcmFkaXVzOiAzMHB4Ow0KfQ0KLmltZy1jb250ZW50IHsNCiAgd2lkdGg6IDEwMCU7DQogIGRpc3BsYXk6IGZsZXg7DQogIGp1c3RpZnktY29udGVudDogY2VudGVyOw0KfQ0KLnVzZXJJbmZvIHsNCiAgZm9udC1zaXplOiAxMnB4Ow0KICBjb2xvcjogc2t5Ymx1ZTsNCn0NCg=="},{"version":3,"sources":["SysAdmin.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2MA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"SysAdmin.vue","sourceRoot":"src/views/sys","sourcesContent":["<template>\r\n  <div>\r\n    <div style=\"display: flex; justify-content: center; margin-top: 20px\">\r\n      <el-input\r\n        placeholder=\"通过用户名搜索用户\"\r\n        prefix-icon=\"el-icon-search\"\r\n        style=\"width: 400px; margin-right: 20px\"\r\n        v-model=\"keywords\"\r\n        @keydown.enter.native=\"doSearch\"\r\n      ></el-input>\r\n      <el-button type=\"primary\" icon=\"el-icon-search\" @click=\"doSearch\"\r\n        >搜索</el-button\r\n      >\r\n    </div>\r\n    <div class=\"admin-container\">\r\n      <el-card class=\"admin-card\" v-for=\"(admin, index) in admins\" :key=\"index\">\r\n        <div slot=\"header\" class=\"clearfix\">\r\n          <span>{{ admin.name }}</span>\r\n          <el-button\r\n            style=\"float: right; padding: 3px 0; color: red\"\r\n            type=\"text\"\r\n            icon=\"el-icon-delete\"\r\n            @click=\"deleteAdmin(admin)\"\r\n          ></el-button>\r\n        </div>\r\n        <div>\r\n          <div class=\"img-content\">\r\n            <img\r\n              :src=\"admin.userFace\"\r\n              :alt=\"admin.name\"\r\n              :title=\"admin.name\"\r\n              class=\"userFace-img\"\r\n            />\r\n          </div>\r\n        </div>\r\n        <div class=\"userInfo\">\r\n          <div>姓名:{{ admin.name }}</div>\r\n          <div>手机号码:{{ admin.phone }}</div>\r\n          <div>电话号码:{{ admin.telephone }}</div>\r\n          <div>地址:{{ admin.address }}</div>\r\n          <div>\r\n            用户状态:\r\n            <el-switch\r\n              v-model=\"admin.enabled\"\r\n              active-color=\"#13ce66\"\r\n              inactive-color=\"#ff4949\"\r\n              active-text=\"启用\"\r\n              inactive-text=\"禁用\"\r\n              @change=\"enabledChange(admin)\"\r\n            >\r\n            </el-switch>\r\n          </div>\r\n          <div>\r\n            用户角色:\r\n            <el-tag\r\n              style=\"margin-right: 10px\"\r\n              type=\"success\"\r\n              v-for=\"(role, indexj) in admin.roles\"\r\n              :key=\"indexj\"\r\n              >{{ role.nameZh }}</el-tag\r\n            >\r\n            <el-popover\r\n              placement=\"right\"\r\n              title=\"角色列表\"\r\n              width=\"200\"\r\n              @show=\"showPop(admin)\"\r\n              @hide=\"hidePop(admin)\"\r\n              trigger=\"click\"\r\n            >\r\n              <el-select v-model=\"selectRoles\" multiple placeholder=\"请选择\">\r\n                <el-option\r\n                  v-for=\"(r, index) in allRoles\"\r\n                  :key=\"index\"\r\n                  :label=\"r.nameZh\"\r\n                  :value=\"r.id\"\r\n                >\r\n                </el-option>\r\n              </el-select>\r\n              <el-button\r\n                slot=\"reference\"\r\n                type=\"text\"\r\n                icon=\"el-icon-more\"\r\n              ></el-button>\r\n            </el-popover>\r\n          </div>\r\n          <div>备注: {{ admin.remark }}</div>\r\n        </div>\r\n      </el-card>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: \"SysAdmin\",\r\n  data() {\r\n    return {\r\n      admins: [],\r\n      keywords: \"\",\r\n      allRoles: [],\r\n      selectRoles: [],\r\n    };\r\n  },\r\n  mounted() {\r\n    this.initAdmins();\r\n  },\r\n  methods: {\r\n    hidePop(admin) {\r\n      let roles = [];\r\n      Object.assign(roles, admin.roles);\r\n      let flag = false;\r\n      if (roles.length != this.selectRoles.length) {\r\n        flag = true;\r\n      } else {\r\n        for (let i = 0; i < roles.length; i++) {\r\n          let role = roles[i];\r\n          for (let j = 0; j < this.selectRoles.length; j++) {\r\n            let sr = this.selectRoles[j];\r\n            if (role.id == sr) {\r\n              roles.splice(i, 1);\r\n              i--;\r\n              break;\r\n            }\r\n          }\r\n        }\r\n        if (roles.length != 0) {\r\n          flag = true;\r\n        }\r\n      }\r\n      if (flag) {\r\n        let url = \"/admin/updaterole?adminId=\" + admin.id;\r\n        this.selectRoles.forEach((rs) => {\r\n          url += \"&rids=\" + rs;\r\n        });\r\n        this.putRequest(url).then((resp) => {\r\n          if (resp) {\r\n            this.initAdmins();\r\n          }\r\n        });\r\n      }\r\n    },\r\n    showPop(admin) {\r\n      this.initAllRoles();\r\n      let roles = admin.roles;\r\n      this.selectRoles = [];\r\n      roles.forEach((r) => {\r\n        this.selectRoles.push(r.id);\r\n      });\r\n    },\r\n    initAllRoles() {\r\n      this.getRequest(\"/admin/roles\").then((resp) => {\r\n        if (resp) {\r\n          this.allRoles = resp;\r\n        }\r\n      });\r\n    },\r\n    enabledChange(admin) {\r\n      this.putRequest(\"/admin/update\", admin).then((resp) => {\r\n        if (resp) {\r\n          this.initAdmins();\r\n        }\r\n      });\r\n    },\r\n    deleteAdmin(admin) {\r\n      this.$confirm(\r\n        \"此操作将永久删除\" + admin.name + \"用户, 是否继续?\",\r\n        \"提示\",\r\n        {\r\n          confirmButtonText: \"确定\",\r\n          cancelButtonText: \"取消\",\r\n          type: \"warning\",\r\n        }\r\n      )\r\n        .then(() => {\r\n          this.deleteRequest(\"/admin/delete\" + admin.id).then((resp) => {\r\n            if (resp) {\r\n              this.initAdmins();\r\n            }\r\n          });\r\n        })\r\n        .catch(() => {\r\n          this.$message({\r\n            type: \"info\",\r\n            message: \"已取消删除\",\r\n          });\r\n        });\r\n    },\r\n\r\n    doSearch() {\r\n      this.initAdmins();\r\n    },\r\n    initAdmins() {\r\n      this.getRequest(\"/admin/list/?keywords=\" + this.keywords).then((resp) => {\r\n        if (resp) {\r\n          this.admins = resp;\r\n        }\r\n      });\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style>\r\n.admin-card {\r\n  width: 350px;\r\n  margin-bottom: 20px;\r\n}\r\n.admin-container {\r\n  display: flex;\r\n  margin-top: 20px;\r\n  justify-content: space-around;\r\n  flex-wrap: wrap;\r\n}\r\n.userFace-img {\r\n  width: 60px;\r\n  height: 60px;\r\n  border-radius: 30px;\r\n}\r\n.img-content {\r\n  width: 100%;\r\n  display: flex;\r\n  justify-content: center;\r\n}\r\n.userInfo {\r\n  font-size: 12px;\r\n  color: skyblue;\r\n}\r\n</style>"]}]}