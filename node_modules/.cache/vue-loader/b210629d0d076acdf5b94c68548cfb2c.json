{"remainingRequest":"C:\\Users\\Administrator\\Desktop\\yeb3\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Administrator\\Desktop\\yeb3\\src\\views\\sys\\SysAdmin.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\Administrator\\Desktop\\yeb3\\src\\views\\sys\\SysAdmin.vue","mtime":1670155681960},{"path":"C:\\Users\\Administrator\\Desktop\\yeb3\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Desktop\\yeb3\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\Users\\Administrator\\Desktop\\yeb3\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Desktop\\yeb3\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQpleHBvcnQgZGVmYXVsdCB7DQogIG5hbWU6ICJTeXNBZG1pbiIsDQogIGRhdGEoKSB7DQogICAgcmV0dXJuIHsNCiAgICAgIGFkbWluczogW10sDQogICAgICBrZXl3b3JkczogIiIsDQogICAgICBhbGxSb2xlczogW10sDQogICAgICBzZWxlY3RSb2xlczogW10sDQogICAgfTsNCiAgfSwNCiAgbW91bnRlZCgpIHsNCiAgICB0aGlzLmluaXRBZG1pbnMoKTsNCiAgfSwNCiAgbWV0aG9kczogew0KDQogICAgaGlkZVBvcChhZG1pbikgew0KICAgICAgbGV0IHJvbGVzID0gW107DQogICAgICBPYmplY3QuYXNzaWduKHJvbGVzLCBhZG1pbi5yb2xlcyk7DQogICAgICBsZXQgZmxhZyA9IGZhbHNlOw0KICAgICAgaWYgKHJvbGVzLmxlbmd0aCAhPSB0aGlzLnNlbGVjdFJvbGVzLmxlbmd0aCkgew0KICAgICAgICBmbGFnID0gdHJ1ZTsNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcm9sZXMubGVuZ3RoOyBpKyspIHsNCiAgICAgICAgICBsZXQgcm9sZSA9IHJvbGVzW2ldOw0KICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgdGhpcy5zZWxlY3RSb2xlcy5sZW5ndGg7IGorKykgew0KICAgICAgICAgICAgbGV0IHNyID0gdGhpcy5zZWxlY3RSb2xlc1tqXTsNCiAgICAgICAgICAgIGlmIChyb2xlLmlkID09IHNyKSB7DQogICAgICAgICAgICAgIHJvbGVzLnNwbGljZShpLCAxKTsNCiAgICAgICAgICAgICAgaS0tOw0KICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgaWYgKHJvbGVzLmxlbmd0aCAhPSAwKSB7DQogICAgICAgICAgZmxhZyA9IHRydWU7DQogICAgICAgIH0NCiAgICAgIH0NCiAgICAgIGlmIChmbGFnKSB7DQogICAgICAgIGxldCB1cmwgPSAiL2FkbWluL3VwZGF0ZXJvbGU/YWRtaW5JZD0iICsgYWRtaW4uaWQ7DQogICAgICAgIHRoaXMuc2VsZWN0Um9sZXMuZm9yRWFjaCgocnMpID0+IHsNCiAgICAgICAgICB1cmwgKz0gIiZyaWRzPSIgKyByczsNCiAgICAgICAgfSk7DQogICAgICAgIHRoaXMucHV0UmVxdWVzdCh1cmwpLnRoZW4oKHJlc3ApID0+IHsNCiAgICAgICAgICBpZiAocmVzcCkgew0KICAgICAgICAgICAgdGhpcy5pbml0QWRtaW5zKCk7DQogICAgICAgICAgfQ0KICAgICAgICB9KTsNCiAgICAgIH0NCiAgICB9LA0KDQogICAgc2hvd1BvcChhZG1pbikgew0KICAgICAgdGhpcy5pbml0QWxsUm9sZXMoKTsNCiAgICAgIGxldCByb2xlcyA9IGFkbWluLnJvbGVzOw0KICAgICAgdGhpcy5zZWxlY3RSb2xlcyA9IFtdOw0KICAgICAgcm9sZXMuZm9yRWFjaCgocikgPT4gew0KICAgICAgICB0aGlzLnNlbGVjdFJvbGVzLnB1c2goci5pZCk7DQogICAgICB9KTsNCiAgICB9LA0KDQogICAgaW5pdEFsbFJvbGVzKCkgew0KICAgICAgdGhpcy5nZXRSZXF1ZXN0KCIvYWRtaW4vcm9sZXMiKS50aGVuKChyZXNwKSA9PiB7DQogICAgICAgIGlmIChyZXNwKSB7DQogICAgICAgICAgdGhpcy5hbGxSb2xlcyA9IHJlc3A7DQogICAgICAgIH0NCiAgICAgIH0pOw0KICAgIH0sDQoNCiAgICBlbmFibGVkQ2hhbmdlKGFkbWluKSB7DQogICAgICB0aGlzLnB1dFJlcXVlc3QoIi9hZG1pbi91cGRhdGUiLCBhZG1pbikudGhlbigocmVzcCkgPT4gew0KICAgICAgICBpZiAocmVzcCkgew0KICAgICAgICAgIHRoaXMuaW5pdEFkbWlucygpOw0KICAgICAgICB9DQogICAgICB9KTsNCiAgICB9LA0KDQogICAgZGVsZXRlQWRtaW4oYWRtaW4pIHsNCiAgICAgIHRoaXMuJGNvbmZpcm0oIuatpOaTjeS9nOWwhuawuOS5heWIoOmZpCIgKyBhZG1pbi5uYW1lICsgIueUqOaItywg5piv5ZCm57un57utPyIsICLmj5DnpLoiLA0KICAgICAgICAgIHsNCiAgICAgICAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiAi56Gu5a6aIiwNCiAgICAgICAgICAgIGNhbmNlbEJ1dHRvblRleHQ6ICLlj5bmtogiLA0KICAgICAgICAgICAgdHlwZTogIndhcm5pbmciDQogICAgICAgICAgfQ0KICAgICAgKS50aGVuKCgpID0+IHsNCiAgICAgICAgdGhpcy5kZWxldGVSZXF1ZXN0KCIvYWRtaW4vZGVsZXRlP2lkPSIgKyBhZG1pbi5pZCkudGhlbigocmVzcCkgPT4gew0KICAgICAgICAgIGlmIChyZXNwKSB7DQogICAgICAgICAgICB0aGlzLmluaXRBZG1pbnMoKTsNCiAgICAgICAgICB9DQogICAgICAgIH0pOw0KICAgICAgfSkuY2F0Y2goKCkgPT4gew0KICAgICAgICB0aGlzLiRtZXNzYWdlKHsNCiAgICAgICAgICB0eXBlOiAiaW5mbyIsDQogICAgICAgICAgbWVzc2FnZTogIuW3suWPlua2iOWIoOmZpCIsDQogICAgICAgIH0pOw0KICAgICAgfSk7DQogICAgfSwNCg0KICAgIGRvU2VhcmNoKCkgew0KICAgICAgdGhpcy5pbml0QWRtaW5zKCk7DQogICAgfSwNCg0KICAgIGluaXRBZG1pbnMoKSB7DQogICAgICB0aGlzLmdldFJlcXVlc3QoIi9hZG1pbi9saXN0P2tleXdvcmRzPSIgKyB0aGlzLmtleXdvcmRzKS50aGVuKChyZXNwKSA9PiB7DQogICAgICAgIGlmIChyZXNwKSB7DQogICAgICAgICAgdGhpcy5hZG1pbnMgPSByZXNwOw0KICAgICAgICB9DQogICAgICB9KTsNCiAgICB9LA0KICB9LA0KfTsNCg=="},{"version":3,"sources":["SysAdmin.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"SysAdmin.vue","sourceRoot":"src/views/sys","sourcesContent":["<template>\r\n  <div>\r\n\r\n    <div style=\"display: flex; justify-content: center; margin-top: 20px\">\r\n      <el-input\r\n          placeholder=\"通过用户名搜索用户\"\r\n          prefix-icon=\"el-icon-search\"\r\n          style=\"width: 400px; margin-right: 20px\"\r\n          v-model=\"keywords\"\r\n          @keydown.enter.native=\"doSearch\">\r\n      </el-input>\r\n      <el-button type=\"primary\" icon=\"el-icon-search\" @click=\"doSearch\">搜索</el-button>\r\n    </div>\r\n\r\n    <div class=\"admin-container\">\r\n      <el-card class=\"admin-card\" v-for=\"(admin, index) in admins\" :key=\"index\">\r\n\r\n        <div slot=\"header\" class=\"clearfix\">\r\n          <span>{{ admin.name }}</span>\r\n          <el-button\r\n              style=\"float: right; padding: 3px 0; color: red\"\r\n              type=\"text\"\r\n              icon=\"el-icon-delete\"\r\n              @click=\"deleteAdmin(admin)\">\r\n          </el-button>\r\n        </div>\r\n\r\n        <div>\r\n          <div class=\"img-content\">\r\n            <img :src=\"admin.userFace\" :alt=\"admin.name\" :title=\"admin.name\" class=\"userFace-img\"/>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"userInfo\">\r\n          <div>姓名:{{ admin.name }}</div>\r\n          <div>手机号码:{{ admin.phone }}</div>\r\n          <div>电话号码:{{ admin.telephone }}</div>\r\n          <div>地址:{{ admin.address }}</div>\r\n\r\n          <div>用户状态:\r\n            <el-switch\r\n                v-model=\"admin.enabled\"\r\n                active-color=\"#13ce66\"\r\n                inactive-color=\"#ff4949\"\r\n                active-text=\"启用\"\r\n                inactive-text=\"禁用\"\r\n                @change=\"enabledChange(admin)\">\r\n            </el-switch>\r\n          </div>\r\n\r\n          <div>用户角色:\r\n            <el-tag style=\"margin-right: 10px\" type=\"success\" v-for=\"(role, indexj) in admin.roles\" :key=\"indexj\">\r\n              {{ role.nameZh }}\r\n            </el-tag>\r\n\r\n            <el-popover\r\n                placement=\"right\"\r\n                title=\"角色列表\"\r\n                width=\"200\"\r\n                @show=\"showPop(admin)\"\r\n                @hide=\"hidePop(admin)\"\r\n                trigger=\"click\">\r\n              <el-select v-model=\"selectRoles\" multiple placeholder=\"请选择\">\r\n                <el-option\r\n                    v-for=\"(r, index) in allRoles\"\r\n                    :key=\"index\"\r\n                    :label=\"r.nameZh\"\r\n                    :value=\"r.id\">\r\n                </el-option>\r\n              </el-select>\r\n\r\n              <el-button slot=\"reference\" type=\"text\" icon=\"el-icon-more\"></el-button>\r\n            </el-popover>\r\n          </div>\r\n\r\n          <div>备注: {{ admin.remark }}</div>\r\n\r\n        </div>\r\n      </el-card>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: \"SysAdmin\",\r\n  data() {\r\n    return {\r\n      admins: [],\r\n      keywords: \"\",\r\n      allRoles: [],\r\n      selectRoles: [],\r\n    };\r\n  },\r\n  mounted() {\r\n    this.initAdmins();\r\n  },\r\n  methods: {\r\n\r\n    hidePop(admin) {\r\n      let roles = [];\r\n      Object.assign(roles, admin.roles);\r\n      let flag = false;\r\n      if (roles.length != this.selectRoles.length) {\r\n        flag = true;\r\n      } else {\r\n        for (let i = 0; i < roles.length; i++) {\r\n          let role = roles[i];\r\n          for (let j = 0; j < this.selectRoles.length; j++) {\r\n            let sr = this.selectRoles[j];\r\n            if (role.id == sr) {\r\n              roles.splice(i, 1);\r\n              i--;\r\n              break;\r\n            }\r\n          }\r\n        }\r\n        if (roles.length != 0) {\r\n          flag = true;\r\n        }\r\n      }\r\n      if (flag) {\r\n        let url = \"/admin/updaterole?adminId=\" + admin.id;\r\n        this.selectRoles.forEach((rs) => {\r\n          url += \"&rids=\" + rs;\r\n        });\r\n        this.putRequest(url).then((resp) => {\r\n          if (resp) {\r\n            this.initAdmins();\r\n          }\r\n        });\r\n      }\r\n    },\r\n\r\n    showPop(admin) {\r\n      this.initAllRoles();\r\n      let roles = admin.roles;\r\n      this.selectRoles = [];\r\n      roles.forEach((r) => {\r\n        this.selectRoles.push(r.id);\r\n      });\r\n    },\r\n\r\n    initAllRoles() {\r\n      this.getRequest(\"/admin/roles\").then((resp) => {\r\n        if (resp) {\r\n          this.allRoles = resp;\r\n        }\r\n      });\r\n    },\r\n\r\n    enabledChange(admin) {\r\n      this.putRequest(\"/admin/update\", admin).then((resp) => {\r\n        if (resp) {\r\n          this.initAdmins();\r\n        }\r\n      });\r\n    },\r\n\r\n    deleteAdmin(admin) {\r\n      this.$confirm(\"此操作将永久删除\" + admin.name + \"用户, 是否继续?\", \"提示\",\r\n          {\r\n            confirmButtonText: \"确定\",\r\n            cancelButtonText: \"取消\",\r\n            type: \"warning\"\r\n          }\r\n      ).then(() => {\r\n        this.deleteRequest(\"/admin/delete?id=\" + admin.id).then((resp) => {\r\n          if (resp) {\r\n            this.initAdmins();\r\n          }\r\n        });\r\n      }).catch(() => {\r\n        this.$message({\r\n          type: \"info\",\r\n          message: \"已取消删除\",\r\n        });\r\n      });\r\n    },\r\n\r\n    doSearch() {\r\n      this.initAdmins();\r\n    },\r\n\r\n    initAdmins() {\r\n      this.getRequest(\"/admin/list?keywords=\" + this.keywords).then((resp) => {\r\n        if (resp) {\r\n          this.admins = resp;\r\n        }\r\n      });\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style>\r\n.admin-card {\r\n  width: 350px;\r\n  margin-bottom: 20px;\r\n}\r\n\r\n.admin-container {\r\n  display: flex;\r\n  margin-top: 20px;\r\n  justify-content: space-around;\r\n  flex-wrap: wrap;\r\n}\r\n\r\n.userFace-img {\r\n  width: 60px;\r\n  height: 60px;\r\n  border-radius: 30px;\r\n}\r\n\r\n.img-content {\r\n  width: 100%;\r\n  display: flex;\r\n  justify-content: center;\r\n}\r\n\r\n.userInfo {\r\n  font-size: 12px;\r\n  color: skyblue;\r\n}\r\n</style>"]}]}