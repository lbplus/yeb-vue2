{"remainingRequest":"C:\\Users\\Administrator\\Desktop\\yeb2\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\Administrator\\Desktop\\yeb2\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\Users\\Administrator\\Desktop\\yeb2\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Administrator\\Desktop\\yeb2\\src\\components\\sys\\basic\\PermissMana.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\Administrator\\Desktop\\yeb2\\src\\components\\sys\\basic\\PermissMana.vue","mtime":1669914085669},{"path":"C:\\Users\\Administrator\\Desktop\\yeb2\\babel.config.js","mtime":1636369865443},{"path":"C:\\Users\\Administrator\\Desktop\\yeb2\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Desktop\\yeb2\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\Users\\Administrator\\Desktop\\yeb2\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Desktop\\yeb2\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuZm9yLWVhY2guanMiOwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogIlBlcm1pc3NNYW5hIiwKICBkYXRhOiBmdW5jdGlvbiBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgcm9sZTogewogICAgICAgIG5hbWU6ICIiLAogICAgICAgIG5hbWVaaDogIiIKICAgICAgfSwKICAgICAgcm9sZXM6IFtdLAogICAgICBhbGxNZW51czogW10sCiAgICAgIGRlZmF1bHRQcm9wczogewogICAgICAgIGNoaWxkcmVuOiAiY2hpbGRyZW4iLAogICAgICAgIGxhYmVsOiAibmFtZSIKICAgICAgfSwKICAgICAgc2VsZWN0ZWRNZW51czogW10sCiAgICAgIGFjdGl2ZU5hbWU6IC0xCiAgICB9OwogIH0sCiAgbW91bnRlZDogZnVuY3Rpb24gbW91bnRlZCgpIHsKICAgIHRoaXMuaW5pdFJvbGVzKCk7CiAgfSwKICBtZXRob2RzOiB7CiAgICBkb0RlbGV0ZVJvbGU6IGZ1bmN0aW9uIGRvRGVsZXRlUm9sZShyb2xlKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICB0aGlzLiRjb25maXJtKCLliKDpmaRbIiArIHJvbGUubmFtZVpoICsgIl3op5LoibIsIOaYr+WQpue7p+e7rT8iLCAi5o+Q56S6IiwgewogICAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiAi56Gu5a6aIiwKICAgICAgICBjYW5jZWxCdXR0b25UZXh0OiAi5Y+W5raIIiwKICAgICAgICB0eXBlOiAid2FybmluZyIKICAgICAgfSkudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgX3RoaXMuZGVsZXRlUmVxdWVzdCgiL3N5c3RlbS9iYXNpYy9wZXJtaXNzaW9uL2RlbGV0ZT9pZD0iICsgcm9sZS5pZCkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgICBpZiAocmVzKSB7CiAgICAgICAgICAgIF90aGlzLmluaXRSb2xlcygpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9KS5jYXRjaChmdW5jdGlvbiAoKSB7CiAgICAgICAgX3RoaXMuJG1lc3NhZ2UoewogICAgICAgICAgdHlwZTogImluZm8iLAogICAgICAgICAgbWVzc2FnZTogIuW3suWPlua2iOWIoOmZpCIKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9LAogICAgZG9BZGRSb2xlOiBmdW5jdGlvbiBkb0FkZFJvbGUoKSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgICAgaWYgKHRoaXMucm9sZS5uYW1lICYmIHRoaXMucm9sZS5uYW1lWmgpIHsKICAgICAgICB0aGlzLnBvc3RSZXF1ZXN0KCIvc3lzdGVtL2Jhc2ljL3Blcm1pc3Npb24vYWRkIiwgdGhpcy5yb2xlKS50aGVuKGZ1bmN0aW9uIChyZXNwKSB7CiAgICAgICAgICBpZiAocmVzcCkgewogICAgICAgICAgICBfdGhpczIuaW5pdFJvbGVzKCk7CgogICAgICAgICAgICBfdGhpczIucm9sZS5uYW1lID0gIiI7CiAgICAgICAgICAgIF90aGlzMi5yb2xlLm5hbWVaaCA9ICIiOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoIuaJgOacieWtl+auteS4jeiDveS4uuepuiEiKTsKICAgICAgfQogICAgfSwKICAgIGNhbmNlbFVwZGF0ZTogZnVuY3Rpb24gY2FuY2VsVXBkYXRlKCkgewogICAgICB0aGlzLmFjdGl2ZU5hbWUgPSAtMTsKICAgIH0sCiAgICBkb1VwZGF0ZTogZnVuY3Rpb24gZG9VcGRhdGUocmlkLCBpbmRleCkgewogICAgICB2YXIgX3RoaXMzID0gdGhpczsKCiAgICAgIHZhciB0cmVlID0gdGhpcy4kcmVmcy50cmVlW2luZGV4XTsKICAgICAgdmFyIHNlbGVjdGVkS2V5cyA9IHRyZWUuZ2V0Q2hlY2tlZEtleXModHJ1ZSk7CiAgICAgIHZhciB1cmwgPSAiL3N5c3RlbS9iYXNpYy9wZXJtaXNzaW9uL3VwZGF0ZW1lbnVzLz9yaWQ9IiArIHJpZDsKICAgICAgc2VsZWN0ZWRLZXlzLmZvckVhY2goZnVuY3Rpb24gKGtleSkgewogICAgICAgIHVybCArPSAiJm1pZHM9IiArIGtleTsKICAgICAgfSk7CiAgICAgIHRoaXMucHV0UmVxdWVzdCh1cmwpLnRoZW4oZnVuY3Rpb24gKHJlc3ApIHsKICAgICAgICBpZiAocmVzcCkgewogICAgICAgICAgX3RoaXMzLmluaXRSb2xlcygpOwoKICAgICAgICAgIF90aGlzMy5hY3RpdmVOYW1lID0gLTE7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICBjaGFuZ2U6IGZ1bmN0aW9uIGNoYW5nZShyaWQpIHsKICAgICAgaWYgKHJpZCkgewogICAgICAgIHRoaXMuc2VsZWN0ZWRNZW51cyA9IFtdOwogICAgICAgIHRoaXMuaW5pdEFsbE1lbnVzKCk7CiAgICAgICAgdGhpcy5pbml0U2VsZWN0ZWRNZW51cyhyaWQpOwogICAgICB9CiAgICB9LAogICAgaW5pdFNlbGVjdGVkTWVudXM6IGZ1bmN0aW9uIGluaXRTZWxlY3RlZE1lbnVzKHJpZCkgewogICAgICB2YXIgX3RoaXM0ID0gdGhpczsKCiAgICAgIHZhciB1cmwgPSAiL3N5c3RlbS9iYXNpYy9wZXJtaXNzaW9uL21pZC8/cmlkPSIgKyByaWQ7CiAgICAgIHRoaXMuZ2V0UmVxdWVzdCh1cmwpLnRoZW4oZnVuY3Rpb24gKHJlc3ApIHsKICAgICAgICBjb25zb2xlLmxvZyhyZXNwKTsKICAgICAgICBfdGhpczQuc2VsZWN0ZWRNZW51cyA9IHJlc3A7CiAgICAgIH0pOwogICAgfSwKICAgIGluaXRBbGxNZW51czogZnVuY3Rpb24gaW5pdEFsbE1lbnVzKCkgewogICAgICB2YXIgX3RoaXM1ID0gdGhpczsKCiAgICAgIHRoaXMuZ2V0UmVxdWVzdCgiL3N5c3RlbS9iYXNpYy9wZXJtaXNzaW9uL21lbnVzIikudGhlbihmdW5jdGlvbiAocmVzcCkgewogICAgICAgIGlmIChyZXNwKSB7CiAgICAgICAgICBfdGhpczUuYWxsTWVudXMgPSByZXNwOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgaW5pdFJvbGVzOiBmdW5jdGlvbiBpbml0Um9sZXMoKSB7CiAgICAgIHZhciBfdGhpczYgPSB0aGlzOwoKICAgICAgdGhpcy5nZXRSZXF1ZXN0KCIvc3lzdGVtL2Jhc2ljL3Blcm1pc3Npb24vbGlzdCIpLnRoZW4oZnVuY3Rpb24gKHJlc3ApIHsKICAgICAgICBpZiAocmVzcCkgewogICAgICAgICAgX3RoaXM2LnJvbGVzID0gcmVzcDsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQogIH0KfTs="},{"version":3,"sources":["PermissMana.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n  <div>\r\n    <div class=\"permissMana\">\r\n      <el-input size=\"small\" placeholder=\"请输入角色英文名\" v-model=\"role.name\">\r\n        <template size=\"small\" slot=\"prepend\">Role_</template>\r\n      </el-input>\r\n      <el-input\r\n        size=\"small\"\r\n        placeholder=\"请输入角色中文名\"\r\n        v-model=\"role.nameZh\"\r\n        @keydown.enter.native=\"doAddRole\"\r\n      >\r\n      </el-input>\r\n      <el-button size=\"small\" type=\"primary\" @click=\"doAddRole\"\r\n        >添加角色</el-button\r\n      >\r\n    </div>\r\n    <div class=\"permissManaMain\">\r\n      <el-collapse v-model=\"activeName\" accordion @change=\"change\">\r\n        <el-collapse-item\r\n          :title=\"r.nameZh\"\r\n          :name=\"r.id\"\r\n          v-for=\"(r, index) in roles\"\r\n          :key=\"index\"\r\n        >\r\n          <el-card class=\"box-card\">\r\n            <div slot=\"header\" class=\"clearfix\">\r\n              <span>可访问资源</span>\r\n              <el-button\r\n                style=\"float: right; padding: 3px 0; color: #ff0000\"\r\n                icon=\"el-icon-delete\"\r\n                type=\"text\"\r\n                @click=\"doDeleteRole(r)\"\r\n              ></el-button>\r\n            </div>\r\n            <div>\r\n              <el-tree\r\n                show-checkbox\r\n                ref=\"tree\"\r\n                :data=\"allMenus\"\r\n                :props=\"defaultProps\"\r\n                :default-checked-keys=\"selectedMenus\"\r\n                :key=\"index\"\r\n                node-key=\"id\"\r\n              ></el-tree>\r\n              <div style=\"display: flex; justify-content: flex-end\">\r\n                <el-button size=\"mini\" @click=\"cancelUpdate\"\r\n                  >取消修改</el-button\r\n                >\r\n                <el-button\r\n                  size=\"mini\"\r\n                  type=\"primary\"\r\n                  @click=\"doUpdate(r.id, index)\"\r\n                  >确认修改</el-button\r\n                >\r\n              </div>\r\n            </div>\r\n          </el-card>\r\n        </el-collapse-item>\r\n      </el-collapse>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: \"PermissMana\",\r\n  data() {\r\n    return {\r\n      role: {\r\n        name: \"\",\r\n        nameZh: \"\",\r\n      },\r\n      roles: [],\r\n      allMenus: [],\r\n      defaultProps: {\r\n        children: \"children\",\r\n        label: \"name\",\r\n      },\r\n      selectedMenus: [],\r\n      activeName: -1,\r\n    };\r\n  },\r\n  mounted() {\r\n    this.initRoles();\r\n  },\r\n  methods: {\r\n    doDeleteRole(role) {\r\n      this.$confirm(\"删除[\" + role.nameZh + \"]角色, 是否继续?\", \"提示\", {\r\n        confirmButtonText: \"确定\",\r\n        cancelButtonText: \"取消\",\r\n        type: \"warning\",\r\n      }).then(() => {\r\n          this.deleteRequest(\"/system/basic/permission/delete?id=\"+role.id).then((res) => {\r\n            if (res) {\r\n              this.initRoles();\r\n            }\r\n          });\r\n        }).catch(() => {\r\n          this.$message({\r\n            type: \"info\",\r\n            message: \"已取消删除\",\r\n          });\r\n        });\r\n    },\r\n    doAddRole() {\r\n      if (this.role.name && this.role.nameZh) {\r\n        this.postRequest(\"/system/basic/permission/add\", this.role).then(\r\n          (resp) => {\r\n            if (resp) {\r\n              this.initRoles();\r\n              this.role.name = \"\";\r\n              this.role.nameZh = \"\";\r\n            }\r\n          }\r\n        );\r\n      } else {\r\n        this.$message.error(\"所有字段不能为空!\");\r\n      }\r\n    },\r\n    cancelUpdate() {\r\n      this.activeName = -1;\r\n    },\r\n    doUpdate(rid, index) {\r\n      let tree = this.$refs.tree[index];\r\n      let selectedKeys = tree.getCheckedKeys(true);\r\n      let url = \"/system/basic/permission/updatemenus/?rid=\" + rid;\r\n      selectedKeys.forEach((key) => {\r\n        url += \"&mids=\" + key;\r\n      });\r\n      this.putRequest(url).then((resp) => {\r\n        if (resp) {\r\n          this.initRoles();\r\n          this.activeName = -1;\r\n        }\r\n      });\r\n    },\r\n    change(rid) {\r\n      if (rid) {\r\n        this.selectedMenus = [];\r\n        this.initAllMenus();\r\n        this.initSelectedMenus(rid);\r\n      }\r\n    },\r\n    initSelectedMenus(rid) {\r\n      let url = \"/system/basic/permission/mid/?rid=\" + rid;\r\n      this.getRequest(url).then((resp) => {\r\n        console.log(resp);\r\n        this.selectedMenus = resp;\r\n      });\r\n    },\r\n    initAllMenus() {\r\n      this.getRequest(\"/system/basic/permission/menus\").then((resp) => {\r\n        if (resp) {\r\n          this.allMenus = resp;\r\n        }\r\n      });\r\n    },\r\n    initRoles() {\r\n      this.getRequest(\"/system/basic/permission/list\").then((resp) => {\r\n        if (resp) {\r\n          this.roles = resp;\r\n        }\r\n      });\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style>\r\n.permissMana {\r\n  display: flex;\r\n  justify-content: flex-start;\r\n}\r\n.permissMana .el-input {\r\n  width: 300px;\r\n  margin-right: 6px;\r\n}\r\n.permissManaMain {\r\n  margin-top: 10px;\r\n  width: 700px;\r\n}\r\n</style>"],"sourceRoot":"src/components/sys/basic"}]}