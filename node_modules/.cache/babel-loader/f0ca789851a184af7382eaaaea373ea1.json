{"remainingRequest":"C:\\Users\\Administrator\\Desktop\\yeb2\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\Administrator\\Desktop\\yeb2\\src\\store\\index.js","dependencies":[{"path":"C:\\Users\\Administrator\\Desktop\\yeb2\\src\\store\\index.js","mtime":1637407706385},{"path":"C:\\Users\\Administrator\\Desktop\\yeb2\\babel.config.js","mtime":1636369865443},{"path":"C:\\Users\\Administrator\\Desktop\\yeb2\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Desktop\\yeb2\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IFZ1ZSBmcm9tICd2dWUnOwppbXBvcnQgVnVleCBmcm9tICd2dWV4JzsKaW1wb3J0IHsgZ2V0UmVxdWVzdCB9IGZyb20gJy4uL3V0aWxzL2FwaSc7CmltcG9ydCBTb2NrSnMgZnJvbSAnc29ja2pzLWNsaWVudCc7CmltcG9ydCBTdG9tcCBmcm9tICdzdG9tcGpzJzsKaW1wb3J0IHsgTm90aWZpY2F0aW9uIH0gZnJvbSAnZWxlbWVudC11aSc7ClZ1ZS51c2UoVnVleCk7CnZhciBub3cgPSBuZXcgRGF0ZSgpOwp2YXIgc3RvcmUgPSBuZXcgVnVleC5TdG9yZSh7CiAgLy8gIOWFqOWxgOWvueixoQogIHN0YXRlOiB7CiAgICByb3V0ZXM6IFtdLAogICAgc2Vzc2lvbnM6IHt9LAogICAgYWRtaW5zOiBbXSwKICAgIGN1cnJlbnRTZXNzaW9uOiBudWxsLAogICAgY3VycmVudEFkbWluOiBKU09OLnBhcnNlKHdpbmRvdy5zZXNzaW9uU3RvcmFnZS5nZXRJdGVtKCd1c2VyJykpLAogICAgZmlsdGVyS2V5OiAnJywKICAgIHN0b21wOiBudWxsLAogICAgaXNEb3Q6IHt9CiAgfSwKICAvLyAg5pS55Y+Yc3RhdGXph4zlr7nlupTlgLznmoTmlrnms5UKICBtdXRhdGlvbnM6IHsKICAgIGluaXRSb3V0ZXM6IGZ1bmN0aW9uIGluaXRSb3V0ZXMoc3RhdGUsIGRhdGEpIHsKICAgICAgc3RhdGUucm91dGVzID0gZGF0YTsKICAgIH0sCiAgICBjaGFuZ2VjdXJyZW50U2Vzc2lvbjogZnVuY3Rpb24gY2hhbmdlY3VycmVudFNlc3Npb24oc3RhdGUsIGN1cnJlbnRTZXNzaW9uKSB7CiAgICAgIHN0YXRlLmN1cnJlbnRTZXNzaW9uID0gY3VycmVudFNlc3Npb247CiAgICAgIFZ1ZS5zZXQoc3RhdGUuaXNEb3QsIHN0YXRlLmN1cnJlbnRBZG1pbi51c2VybmFtZSArICcjJyArIHN0YXRlLmN1cnJlbnRTZXNzaW9uLnVzZXJuYW1lLCBmYWxzZSk7CiAgICB9LAogICAgYWRkTWVzc2FnZTogZnVuY3Rpb24gYWRkTWVzc2FnZShzdGF0ZSwgbXNnKSB7CiAgICAgIHZhciBtc3MgPSBzdGF0ZS5zZXNzaW9uc1tzdGF0ZS5jdXJyZW50QWRtaW4udXNlcm5hbWUgKyAiIyIgKyBtc2cudG9dOwoKICAgICAgaWYgKCFtc3MpIHsKICAgICAgICBWdWUuc2V0KHN0YXRlLnNlc3Npb25zLCBzdGF0ZS5jdXJyZW50QWRtaW4udXNlcm5hbWUgKyAnIycgKyBtc2cudG8sIFtdKTsKICAgICAgfQoKICAgICAgc3RhdGUuc2Vzc2lvbnNbc3RhdGUuY3VycmVudEFkbWluLnVzZXJuYW1lICsgIiMiICsgbXNnLnRvXS5wdXNoKHsKICAgICAgICBjb250ZW50OiBtc2cuY29udGVudCwKICAgICAgICBkYXRlOiBuZXcgRGF0ZSgpLAogICAgICAgIHNlbGY6ICFtc2cubm90U2VsZgogICAgICB9KTsKICAgIH0sCiAgICBJTklUX0RBVEE6IGZ1bmN0aW9uIElOSVRfREFUQShzdGF0ZSkgewogICAgICAvLyAg5rWP6KeI5Zmo5pys5Zyw55qE5Y6G5Y+y6IGK5aSp6K6w5b2VCiAgICAgIHZhciBkYXRhID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3Z1ZS1jaGF0LXNlc3Npb24nKTsgLy9jb25zb2xlLmxvZyhkYXRhKQoKICAgICAgaWYgKGRhdGEpIHsKICAgICAgICBzdGF0ZS5zZXNzaW9ucyA9IEpTT04ucGFyc2UoZGF0YSk7CiAgICAgIH0KICAgIH0sCiAgICBJTklUX0FETUlOUzogZnVuY3Rpb24gSU5JVF9BRE1JTlMoc3RhdGUsIGRhdGEpIHsKICAgICAgc3RhdGUuYWRtaW5zID0gZGF0YTsKICAgIH0sCiAgICBJTklUX0FETUlOOiBmdW5jdGlvbiBJTklUX0FETUlOKHN0YXRlLCBhZG1pbikgewogICAgICBzdGF0ZS5jdXJyZW50QWRtaW4gPSBhZG1pbjsKICAgIH0KICB9LAogIC8vICDlvILmraXmiafooYwKICBhY3Rpb25zOiB7CiAgICBjb25uZWN0OiBmdW5jdGlvbiBjb25uZWN0KGNvbnRleHQpIHsKICAgICAgY29uc29sZS5sb2coY29udGV4dCk7CiAgICAgIGNvbnRleHQuc3RhdGUuc3RvbXAgPSBTdG9tcC5vdmVyKG5ldyBTb2NrSnMoJy93cy9lcCcpKTsKICAgICAgdmFyIHRva2VuID0gd2luZG93LnNlc3Npb25TdG9yYWdlLmdldEl0ZW0oJ3Rva2VuU3RyJyk7CiAgICAgIGNvbnRleHQuc3RhdGUuc3RvbXAuY29ubmVjdCh7CiAgICAgICAgJ0F1dGgtVG9rZW4nOiB0b2tlbgogICAgICB9LCBmdW5jdGlvbiAoc3VjY2VzcykgewogICAgICAgIGNvbnRleHQuc3RhdGUuc3RvbXAuc3Vic2NyaWJlKCcvdXNlci9xdWV1ZS9jaGF0JywgZnVuY3Rpb24gKG1zZykgewogICAgICAgICAgdmFyIHJlY2VpdmVNc2cgPSBKU09OLnBhcnNlKG1zZy5ib2R5KTsKCiAgICAgICAgICBpZiAoY29udGV4dC5zdGF0ZS5jdXJyZW50U2Vzc2lvbiB8fCByZWNlaXZlTXNnLmZyb20gIT0gY29udGV4dC5zdGF0ZS5jdXJyZW50QWRtaW4udXNlcm5hbWUpIHsKICAgICAgICAgICAgTm90aWZpY2F0aW9uLmluZm8oewogICAgICAgICAgICAgIHRpdGxlOiAnWycgKyByZWNlaXZlTXNnLmZvcm1OaWNrTmFtZSArICdd5Y+R5p2l5LiA5p2h5raI5oGvJywKICAgICAgICAgICAgICBtZXNzYWdlOiByZWNlaXZlTXNnLmNvbnRlbnQubGVuZ3RoID4gMTAgPyByZWNlaXZlTXNnLmNvbnRlbnQuc3Vic3RyKDAsIDEwKSA6IHJlY2VpdmVNc2cuY29udGVudCwKICAgICAgICAgICAgICBwb3NpdGlvbjogJ2JvdHRvbS1yaWdodCcKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIFZ1ZS5zZXQoY29udGV4dC5zdGF0ZS5pc0RvdCwgY29udGV4dC5zdGF0ZS5jdXJyZW50QWRtaW4udXNlcm5hbWUgKyAnIycgKyByZWNlaXZlTXNnLmZyb20sIHRydWUpOwogICAgICAgICAgfQoKICAgICAgICAgIDsKICAgICAgICAgIHJlY2VpdmVNc2cubm90U2VsZiA9IHRydWU7CiAgICAgICAgICByZWNlaXZlTXNnLnRvID0gcmVjZWl2ZU1zZy5mcm9tOwogICAgICAgICAgY29udGV4dC5jb21taXQoJ2FkZE1lc3NhZ2UnLCByZWNlaXZlTXNnKTsKICAgICAgICB9KTsKICAgICAgfSwgZnVuY3Rpb24gKGVycm9yKSB7fSk7CiAgICB9LAogICAgaW5pdERhdGE6IGZ1bmN0aW9uIGluaXREYXRhKGNvbnRleHQpIHsKICAgICAgY29udGV4dC5jb21taXQoJ0lOSVRfREFUQScpOwogICAgICBnZXRSZXF1ZXN0KCcvY2hhdC9hZG1pbicpLnRoZW4oZnVuY3Rpb24gKHJlc3ApIHsKICAgICAgICBpZiAocmVzcCkgewogICAgICAgICAgY29udGV4dC5jb21taXQoJ0lOSVRfQURNSU5TJywgcmVzcCk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0KICB9LAogIG1vZHVsZXM6IHt9Cn0pOwpzdG9yZS53YXRjaChmdW5jdGlvbiAoc3RhdGUpIHsKICByZXR1cm4gc3RhdGUuc2Vzc2lvbnM7Cn0sIGZ1bmN0aW9uICh2YWwpIHsKICBjb25zb2xlLmxvZygnQ0hBTkdFOiAnLCB2YWwpOwogIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCd2dWUtY2hhdC1zZXNzaW9uJywgSlNPTi5zdHJpbmdpZnkodmFsKSk7Cn0sIHsKICBkZWVwOiB0cnVlCiAgLyrov5nkuKrosozkvLzmmK/lvIDlkK93YXRjaOebkea1i+eahOWIpOaWrSzlrpjmlrnor7TmmI7kuZ/mr5TovoPmqKHns4oqLwoKfSk7CmV4cG9ydCBkZWZhdWx0IHN0b3JlOw=="},{"version":3,"sources":["C:/Users/Administrator/Desktop/yeb2/src/store/index.js"],"names":["Vue","Vuex","getRequest","SockJs","Stomp","Notification","use","now","Date","store","Store","state","routes","sessions","admins","currentSession","currentAdmin","JSON","parse","window","sessionStorage","getItem","filterKey","stomp","isDot","mutations","initRoutes","data","changecurrentSession","set","username","addMessage","msg","mss","to","push","content","date","self","notSelf","INIT_DATA","localStorage","INIT_ADMINS","INIT_ADMIN","admin","actions","connect","context","console","log","over","token","success","subscribe","receiveMsg","body","from","info","title","formNickName","message","length","substr","position","commit","error","initData","then","resp","modules","watch","val","setItem","stringify","deep"],"mappings":"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","sourcesContent":["import Vue from 'vue'\nimport Vuex from 'vuex'\nimport { getRequest } from '../utils/api'\nimport SockJs from 'sockjs-client'\nimport Stomp from 'stompjs'\nimport { Notification } from 'element-ui'\n\nVue.use(Vuex)\n\nconst now = new Date()\n\nconst store = new Vuex.Store({\n    //  全局对象\n    state: {\n        routes: [],\n        sessions: {},\n        admins: [],\n        currentSession: null,\n        currentAdmin: JSON.parse(window.sessionStorage.getItem('user')),\n        filterKey: '',\n        stomp: null,\n        isDot: {}\n    },\n    //  改变state里对应值的方法\n    mutations: {\n        initRoutes(state, data) {\n            state.routes = data;\n        },\n        changecurrentSession(state, currentSession) {\n            state.currentSession = currentSession;\n            Vue.set(state.isDot, state.currentAdmin.username + '#' + state.currentSession.username, false);\n        },\n        addMessage(state, msg) {\n            let mss = state.sessions[state.currentAdmin.username + \"#\" + msg.to];\n            if (!mss) {\n                Vue.set(state.sessions, state.currentAdmin.username + '#' + msg.to, []);\n            }\n            state.sessions[state.currentAdmin.username + \"#\" + msg.to].push({\n                content: msg.content,\n                date: new Date(),\n                self: !msg.notSelf\n            })\n        },\n        INIT_DATA(state) {\n            //  浏览器本地的历史聊天记录\n            let data = localStorage.getItem('vue-chat-session');\n            //console.log(data)\n            if (data) {\n                state.sessions = JSON.parse(data);\n            }\n        },\n        INIT_ADMINS(state, data) {\n            state.admins = data;\n        },\n        INIT_ADMIN(state, admin) {\n            state.currentAdmin = admin\n        }\n    },\n    //  异步执行\n    actions: {\n        connect(context) {\n            console.log(context);\n\n            context.state.stomp = Stomp.over(new SockJs('/ws/ep'));\n            let token = window.sessionStorage.getItem('tokenStr');\n            context.state.stomp.connect({ 'Auth-Token': token }, success => {\n                context.state.stomp.subscribe('/user/queue/chat', msg => {\n                    let receiveMsg = JSON.parse(msg.body);\n                    if (context.state.currentSession || receiveMsg.from != context.state.currentAdmin.username) {\n                        Notification.info({\n                            title: '[' + receiveMsg.formNickName + ']发来一条消息',\n                            message: receiveMsg.content.length > 10 ? receiveMsg.content.substr(0, 10) : receiveMsg.content,\n                            position: 'bottom-right'\n                        });\n                        Vue.set(context.state.isDot, context.state.currentAdmin.username + '#' + receiveMsg.from, true);\n                    };\n                    receiveMsg.notSelf = true;\n                    receiveMsg.to = receiveMsg.from;\n                    context.commit('addMessage', receiveMsg);\n                })\n            }, error => {\n\n            })\n        },\n        initData(context) {\n            context.commit('INIT_DATA');\n            getRequest('/chat/admin').then(resp => {\n                if (resp) {\n                    context.commit('INIT_ADMINS', resp)\n                }\n            })\n        },\n    },\n    modules: {}\n})\n\nstore.watch(function(state) {\n    return state.sessions\n}, function(val) {\n    console.log('CHANGE: ', val);\n    localStorage.setItem('vue-chat-session', JSON.stringify(val));\n}, {\n    deep: true /*这个貌似是开启watch监测的判断,官方说明也比较模糊*/\n})\n\n\nexport default store;"]}]}